!function(e){Object.assign||Object.defineProperty(Object,"assign",{enumerable:!1,configurable:!0,writable:!0,value:function(e,s){"use strict";if(void 0===e||null===e)throw new TypeError("Cannot convert first argument to object");for(var i=Object(e),a=1;a<arguments.length;a++){var t=arguments[a];if(void 0!==t&&null!==t)for(var l=Object.keys(Object(t)),o=0,n=l.length;n>o;o++){var c=l[o],r=Object.getOwnPropertyDescriptor(t,c);void 0!==r&&r.enumerable&&(i[c]=t[c])}}return i}});var s=$(".musicMedia-wrap");s.html('<div class="musicMedia-player"><div class="musicMedia-player-header-options clear-select"><i class="musicMedia-player-header-option musicMedia-player-header-logo"></i><span class="musicMedia-player-header-title text-ellipsis"></span><span class="musicMedia-player-header-singer text-ellipsis"></span><button class="musicMedia-player-header-option musicMedia-player-min" title="最小化"></button><button class="musicMedia-player-header-option musicMedia-player-close" title="关闭"></button></div><audio></audio><figure class="musicMedia-player-album-bg"><div class="musicMedia-player-controls"><div class="musicMedia-player-process-wrap"><div class="process-part process-left"><div class="c-process c-process-left"></div></div><div class="process-part process-right"><div class="c-process c-process-right"></div></div></div><button class="major-btn"><i class="pause none"></i><i class="play"></i></button></div><img alt="alumn"><div class="musicMedia-player-album-span"></div><div class="musicMedia-player-album-disc stop"><img alt="alumn"></div></figure><div class="musicMedia-player-info"><button class="music-control prev-muisc" title="上一首"></button><button class="music-control next-muisc" title="下一首"></button><div class="music-album-name"><span class="text-ellipsis"></span></div><div class="music-favorite-name"><span class="text-ellipsis"></span></div><div class="music-time"><span class="now-time">00:00</span>/<span class="all-time">00:00</span></div></div><div class="musicMedia-player-footer-options"><div class="musicMedia-player-vol"><span class="volume-switch no-mute" title="禁音"></span><div class="musicMedia-player-vol-process" title="声音"><div class="musicMedia-player-vol-process-anchor" title="声音"></div></div></div><button class="musicMedia-player-muisc-menu" title="歌曲列表"></button><button class="play-mode-list random-play" title="随机播放"></button></div></div><figure class="music-media-bg"><img alt="bg"></figure><div class="musicMedia-player-list-wrap clear-select n-h"><section class="musicMedia-player-list-box"><ul class="musicMedia-player-list clearfix"><li class="favorite-list"></li><li class="music-list"></li></ul></section><div class="musicMedia-player-list-bg"></div></div><div class="musicMedia-player-minimize clear-select minimize-hidden"><i></i><span>音乐歌单</span></div>');var i=$(".major-btn"),a=$(".major-btn .pause"),t=$(".major-btn .play"),l=$(".musicMedia-player-album-disc"),o=$(".play-mode-list"),n=2,c=$(".prev-muisc"),r=$(".next-muisc"),u=$(".musicMedia-player-close"),d=$(".musicMedia-wrap audio")[0],m=$(".c-process-left"),p=$(".c-process-right"),v=null,f=0,h=$(".musicMedia-player-header-singer"),g=$(".music-album-name span"),b=$(".musicMedia-player-header-title"),y=$(".music-favorite-name span"),M=$(".now-time"),w=$(".all-time"),C=$(".musicMedia-player-vol"),L=$(".volume-switch"),x=$(".musicMedia-player-vol-process-anchor"),k=$(".musicMedia-player-vol-process"),T=$(".musicMedia-player-muisc-menu"),N=$(".musicMedia-player-list-wrap"),j=$(".musicMedia-player-list-box"),O=($(".musicMedia-player-list-bg"),$(".musicMedia-player-list")),D=($(".domain-title"),$(".favorite-list")),q=$(".music-list"),H=!1,A=$(".musicMedia-player-album-bg img"),E=$(".musicMedia-player-album-disc img"),X=$(".music-media-bg img"),z=$(".musicMedia-player-header-options"),B=$(".musicMedia-wrap"),Y=B.outerWidth(),I=B.outerHeight(),S=j.height(),P=$(".musicMedia-player-min"),F=$(".musicMedia-player-minimize");$.fn.musicMedia=function(e,s){function j(e){e>118?e=118:4>=e&&(e=4),d.volume=((e-4)/114).toFixed(2),k.css("width",e),4>=e?(L.removeClass("no-mute"),L.addClass("mute")):(L.addClass("no-mute"),L.removeClass("mute"))}function Q(e){var s=new Audio(me[e].url);s.onloadeddata=function(){d.src=s.src},s.onerror=function(s){var i=$("button[data-favorite-index="+ce+"][data-music-index="+e+"]"),a=i.find(".muisc-name");alert("加载歌曲 <"+a.html()+">出错，为你播放下一首歌曲"),pe.push([ce,e]),delete me[e].url,U()},d.onloadedmetadata=function(){g.html(me[re].AlbumName),b.html(me[re].title),h.html(me[re].singer),w.html(ie(d.duration)),y.html(de[ce].favoriteName),A[0].src=me[re].AlbumBg,E[0].src=me[re].AlbumBg,X[0].src=me[re].AlbumBg}}function W(){a.removeClass("none"),t.addClass("none"),l.removeClass("stop"),l.addClass("move"),setTimeout(function(){d.play(),Z()},800)}function R(){a.addClass("none"),t.removeClass("none"),l.removeClass("move"),l.addClass("stop"),d.pause()}function Z(){switch(f=(d.currentTime/d.duration).toFixed(3),M.html(ie(d.currentTime)),!0){case.5>=f:p.css("transform","rotate("+(-135+360*f)+"deg)"),v=setTimeout(Z,1e3);break;case f>.5&&1>f:p.css("transform","rotate(45deg)"),m.css("transform","rotate("+(-135+360*f-180)+"deg)"),v=setTimeout(Z,1e3);break;case f>=1:m.css("transform","rotate(45deg)"),_()}}function _(){clearTimeout(v),R(),J()}function G(){p.css("transform","rotate(-135deg)"),m.css("transform","rotate(-135deg)")}function J(){switch(G(),MusicListoLis.eq(re).removeClass("active"),n){case 1:break;case 2:if(1===me.length)break;var e=~~(ne()*me.length-1);e>re-1&&++e,re=e,Q(re);break;case 3:U()}MusicListoLis.eq(re).addClass("active"),W()}function K(){MusicListoLis.eq(re).removeClass("active"),0===re?re=me.length-1:re-=1,pe.forEach(function(e){var s=e[0],i=e[1];return ce===s&&re===i?K():void 0}),Q(re),MusicListoLis.eq(re).addClass("active")}function U(){MusicListoLis.eq(re).removeClass("active"),re===me.length-1?re=0:re+=1,pe.forEach(function(e){var s=e[0],i=e[1];return ce===s&&re===i?U():void 0}),Q(re),MusicListoLis.eq(re).addClass("active")}function V(e){ce=e,me=de[ce].musicList}function ee(){var e="";e+='<h2 class="musicMedia-player-list-title"><span class="domain-title text-ellipsis">'+ae.domainName+'</span><span class="lists-name"> - 专辑列表 ('+de.length+')</span></h2><div class="scroll-box"><ol class="clearfix">',de.forEach(function(s,i,a){e+=0===i?'<li class="active">':"<li>",e+="<button data-favorite-index="+i+' ><span class="favorite-name">'+s.favoriteName+"</span></button></li>"}),e+='</ol></div><div class="scroll-bar-box"><div class="scroll-bar"></div></div>',D.html(e)}function se(){var e="";e+='<h2 class="musicMedia-player-list-title"><i class="back-arrow"></i><span class="favorite-title text-ellipsis">'+de[ue].favoriteName+'</span></h2><div class="scroll-box"><ol class="clearfix">',de[ue].musicList.forEach(function(s,i,a){e+=ce===ue&&re===i?'<li class="active">':"<li>",e+="<button data-favorite-index="+ue+" data-music-index="+i+'><span class="muisc-name">'+s.title+'</span><span class="album-name">'+s.AlbumName+"</span></button></li>"}),e+='</ol></div><div class="scroll-bar-box"><div class="scroll-bar"></div></div>',q.html(e),pe.forEach(function(e){var s=e[0],i=e[1],a=$("button[data-favorite-index="+s+"][data-music-index="+i+"]"),t=a.find(".muisc-name"),l=a.parent();a.css({cursor:"not-allowed"}),t.css({color:"red",textDecoration:"line-through"}),l.on("click",function(e){return e.stopPropagation(),!1})})}function ie(e){function s(e){return 9>=e?"0"+e:""+e}e=~~e;var i=s(oe.floor(e%3600/60)),a=s(e%60);return i+":"+a}var ae={domainName:"未知站点的",defaultBg:"./img/dft-muisc-alumn-bg.jpg"},te={favoriteName:"音乐收藏夹",musicList:[]};Object.assign(ae,e);var le={url:"",title:"",AlbumName:"",singer:"",AlbumBg:ae.defaultBg},oe=Math,ne=oe.random,ce=0,re=0,ue=0;MusicListoLis=null;var de=s.map(function(e,s,i){var a={};return Object.assign(a,te,e),a.musicList=a.musicList.map(function(e,s,i){var a={};return Object.assign(a,le,e),a}),a}),me=de[ce].musicList;Q(re);var pe=[];ee();var ve=$(".favorite-list ol li"),fe=$(".musicMedia-player-list-title");se(),MusicListoLis=$(".music-list ol li"),ae.autoHidden&&(B.css("left",-Y),F.removeClass("minimize-hidden")),ae.autoplay&&W(),T.on("click",function(){if(H)ve.each(function(e,s){$(s).removeClass("move-left")}),setTimeout(function(){$(fe).removeClass("move-left"),setTimeout(function(){N.addClass("n-h"),H=!1},200)},100);else{var e=B.offset().top,s=$(document).scrollTop();e>=innerHeight+s-(I+S)&&(B.addClass("musicMedia-wrap-t-5"),setTimeout(function(){B.removeClass("musicMedia-wrap-t-5")},500),B.css("top",innerHeight+s-(I+S))),N.removeClass("n-h"),$(fe).addClass("move-left"),setTimeout(function(){ve.each(function(e,s){$(s).addClass("move-left")})},500),H=!0}}),i.on("click",function(){d.paused?W():R()}),o.on("click",function(){switch(!0){case o.hasClass("single-cycle"):o[0].className="play-mode-list",o.addClass("random-play"),o[0].title="随机播放",n=2;break;case o.hasClass("random-play"):o[0].className="play-mode-list",o.addClass("sequential-play"),o[0].title="顺序播放",n=3;break;case o.hasClass("sequential-play"):o[0].className="play-mode-list",o.addClass("single-cycle"),o[0].title="单曲循环",n=1}}),c.on("click",function(){R(),G(),K(),W()}),r.on("click",function(){R(),G(),U(),W()}),x.Drag(function(e){var s=(k.css("width"),e.left);j(s)}),C.on("click",function(e){var s=e.pageX,i=C.offset().left,a=s-i;j(a)}),F.on("click",function(){B.addClass("musicMedia-wrap-t-5"),B.css("left",0),F.addClass("minimize-hidden"),setTimeout(function(){B.removeClass("musicMedia-wrap-t-5")},500)}),P.on("click",function(){B.addClass("musicMedia-wrap-t-5"),B.css("left",-Y),F.removeClass("minimize-hidden"),setTimeout(function(){B.removeClass("musicMedia-wrap-t-5")},500)}),u.on("click",function(){B.remove()}),B.delegate("img","dragstart",function(){return!1}),D.Scroll(),z.Drag(function(e){var s=innerWidth,i=innerHeight,a=$(document).scrollLeft(),t=$(document).scrollTop(),l=e.kLeft,o=e.kTop,n=i+t-I,c=s+a-Y;return H&&(n=i+t-(I+S)),l>=c&&(l=c),a>=l&&(l=a),o>=n&&(o=n),t>=o&&(o=t),B.css("left",l),B.css("top",o),!1}),D.delegate("button","click",function(e){var s="span"===e.target.tagName.toLowerCase()?e.target.parentNode:e.target,i=~~s.dataset.favoriteIndex;ue=i,se(),q.Scroll(),O.addClass("move-right"),MusicListoLis=$(".music-list ol li")}),q.delegate("button","click",function(e){var s="span"===e.target.tagName.toLowerCase()?e.target.parentNode:e.target,i=~~s.dataset.musicIndex,a=~~s.dataset.favoriteIndex;MusicListoLis.eq(re).removeClass("active"),re=i,MusicListoLis.eq(re).addClass("active"),ve.eq(ce).removeClass("active"),ve.eq(a).addClass("active"),V(a),clearTimeout(v),R(),Q(re),W()}),q.delegate("h2","click",function(e){"span"===e.target.tagName.toLowerCase()?e.target.parentNode:e.target;O.removeClass("move-right")})},$.fn.Drag=function(e){var s=this;s.on("mousedown",function(i){var a=i.clientX-s.position().left,t=i.clientY-s.position().top,l=i.clientX-s.offset().left,o=i.clientY-s.offset().top,n=s.offset().left,c=s.offset().top;$(document).on("mousemove.drag",function(s){var i=s.clientY-t,r=s.clientX-a,u=s.clientY-o,d=s.clientX-l,m=n-r,p=c-i;e&&e({top:i,left:r,kTop:u,kLeft:d,cLeft:n,cTop:c,pLeft:r/n*100,pTop:i/c*100,dLeft:m,dTop:p})}),$(document).on("mouseup.drag",function(){$(document).off("mousemove.drag"),s.off("mouseup.drag")})})},$.fn.Scroll=function(e){var s=this.find("ol"),i=this.find(".scroll-bar-box"),a=i.find(".scroll-bar"),t=i.outerHeight(),l=s.outerHeight(),o=301,n=l-o,c=n*t/l,r=t-c;return 0>=n?void i.css("display","none"):(a.css("height",r),a.Drag(function(e){var i=e.top;i>c?i=c:0>=i&&(i=0),a.css("top",i),s.css("marginTop",-(i*n/c))}),void this.on("mousewheel",function(e,i){var t=a.position().top,l=10,o=t+-i*l;return o>c?o=c:0>=o&&(o=0),a.css("top",o),s.css("marginTop",-(o*n/c)),!1}))}}(jQuery),function(e){function s(s){var i=s||window.event,a=[].slice.call(arguments,1),t=0,l=0,o=0;return s=e.event.fix(i),s.type="mousewheel",i.wheelDelta&&(t=i.wheelDelta/120),i.detail&&(t=-i.detail/3),o=t,void 0!==i.axis&&i.axis===i.HORIZONTAL_AXIS&&(o=0,l=-1*t),void 0!==i.wheelDeltaY&&(o=i.wheelDeltaY/120),void 0!==i.wheelDeltaX&&(l=-1*i.wheelDeltaX/120),a.unshift(s,t,l,o),(e.event.dispatch||e.event.handle).apply(this,a)}var i=["DOMMouseScroll","mousewheel"];if(e.event.fixHooks)for(var a=i.length;a;)e.event.fixHooks[i[--a]]=e.event.mouseHooks;e.event.special.mousewheel={setup:function(){if(this.addEventListener)for(var e=i.length;e;)this.addEventListener(i[--e],s,!1);else this.onmousewheel=s},teardown:function(){if(this.removeEventListener)for(var e=i.length;e;)this.removeEventListener(i[--e],s,!1);else this.onmousewheel=null}},e.fn.extend({mousewheel:function(e){return e?this.bind("mousewheel",e):this.trigger("mousewheel")},unmousewheel:function(e){return this.unbind("mousewheel",e)}})}(jQuery);